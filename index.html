<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Waste Classifier</title>

    <style>
        :root {
            --primary: #4a90e2;
            --bg: #f2f5f9;
            --card-bg: #ffffff;
            --text-dark: #222;
            --text-light: #555;
        }

        body {
            margin: 0;
            background: var(--bg);
            font-family: "Inter", Arial, sans-serif;
        }

        .container {
            max-width: 900px;
            margin: 40px auto;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--text-dark);
            font-size: 2.2rem;
            margin-bottom: 30px;
        }

        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            margin-bottom: 25px;
        }

        h2 {
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        p, li {
            color: var(--text-light);
            font-size: 1rem;
        }

        ol {
            margin-top: 10px;
            padding-left: 22px;
        }

        #webcam-container {
            display: flex;
            justify-content: center;
            margin-top: 15px;
        }

        #label-container div {
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            margin-top: 8px;
            color: var(--text-dark);
        }

        button {
            display: block;
            margin: 10px auto 0 auto;
            padding: 12px 22px;
            background: var(--primary);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.25s;
        }

        button:hover {
            background: #357ac8;
        }
    </style>
</head>

<body>

    <div class="container">

        <h1>Smart Waste Classifier</h1>

        <!-- Problem Section -->
        <div class="card">
            <h2>What Problem Does This Solve?</h2>
            <p>
                Many people struggle to sort waste correctly, which leads to recyclables ending up in landfills
                and organic waste being mixed with plastics and metals. This increases pollution and makes
                recycling less effective.
            </p>
            <p>
                This website uses a machine learning model trained with Teachable Machine to recognize 
                four common waste types: <b>organic waste, metal, plastic, and paper</b>. It helps users sort 
                their trash correctly and reduce contamination.
            </p>
        </div>

        <!-- Instructions -->
        <div class="card">
            <h2>How to Use It</h2>
            <ol>
                <li>Click the <b>Start</b> button below.</li>
                <li>Allow access to your webcam.</li>
                <li>Hold any object (paper, plastic, metal, or organic waste) in front of the camera.</li>
                <li>The model will instantly predict which category the object belongs to.</li>
            </ol>
        </div>

        <!-- Model Section -->
        <div class="card">
            <h2>Live Classifier</h2>
            <button onclick="init()">Start</button>
            <div id="webcam-container"></div>
            <div id="label-container"></div>
        </div>

    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <script type="text/javascript">
        const URL = "./my_model/";

        let model, webcam, labelContainer, maxPredictions;

        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            const flip = true;
            webcam = new tmImage.Webcam(250, 250, flip);
            await webcam.setup();
            await webcam.play();
            window.requestAnimationFrame(loop);

            document.getElementById("webcam-container").appendChild(webcam.canvas);

            labelContainer = document.getElementById("label-container");
            for (let i = 0; i < maxPredictions; i++) {
                labelContainer.appendChild(document.createElement("div"));
            }
        }

        async function loop() {
            webcam.update();
            await predict();
            window.requestAnimationFrame(loop);
        }

        async function predict() {
            const prediction = await model.predict(webcam.canvas);
            for (let i = 0; i < maxPredictions; i++) {
                const classPrediction =
                    `${prediction[i].className}: ${prediction[i].probability.toFixed(2)}`;
                labelContainer.childNodes[i].innerHTML = classPrediction;
            }
        }
    </script>

</body>
</html>
